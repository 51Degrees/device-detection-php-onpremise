<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection On-Premise PHP: onpremise/failureToMatch.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection On-Premise PHP
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">Device detection services for 51Degrees Pipeline</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('onpremise_2failure_to_match_8php-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">onpremise/failureToMatch.php</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>This example shows how the hasValue function can help make sure that meaningful values are returned when checking properties returned from the device detection engine.This example is available in full on <a href="https://github.com/51Degrees/device-detection-php-onpremise/blob/master/examples/onpremise/failureToMatch.php">GitHub</a>.</p>
<p>In this example we create an on premise 51Degrees device detection pipeline, in order to do this you will need a copy of the 51Degrees on-premise library and need to make the following additions to your php.ini file</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><a name="_a0"></a><a class="code" href="class_fifty_one_degrees_hash_engine.html">FiftyOneDegreesHashEngine</a>.data_file = <span class="c-code__comment">// location of the data file</span></div><div class="c-code__line"><a class="code" href="class_fifty_one_degrees_hash_engine.html">FiftyOneDegreesHashEngine</a>.allow_unmatched = <span class="c-code__keyword">false</span></div></div><p>When running under process manager such as Apache MPM or php-fpm, make sure to set performance_profile to MaxPerformance by making the following addition to php.ini file. More details can be found in <a href="https://github.com/51Degrees/device-detection-php-onpremise/blob/master/readme.md">README</a>.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><a class="code" href="class_fifty_one_degrees_hash_engine.html">FiftyOneDegreesHashEngine</a>.performance_profile = MaxPerformance</div></div><p>Expected output:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">Does User-Agent <span class="c-code__stringliteral">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_2 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C114&#39;</span> represent a mobile device?:</div><div class="c-code__line">Yes</div><div class="c-code__line"></div><div class="c-code__line">Does User-Agent <span class="c-code__stringliteral">&#39;nonsense ua...&#39;</span> represent a mobile device?:</div><div class="c-code__line">We don<span class="c-code__stringliteral">&#39;t know for sure. The reason given is:</span></div><div class="c-code__line"><span class="c-code__stringliteral">The results contained a null profile for the component which the required property belongs to.</span></div></div><div class="c-code__block c-code__block--outline"><div class="c-code__line">&lt;?php</div><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2023 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> * (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// First we include the deviceDetectionPipelineBuilder</span></div><div class="c-code__line"></div><div class="c-code__line">require __DIR__ . <span class="c-code__stringliteral">&#39;/../../vendor/autoload.php&#39;</span>;</div><div class="c-code__line"></div><div class="c-code__line">use fiftyone\pipeline\core\PipelineBuilder;</div><div class="c-code__line">use <a name="_a1"></a><a class="code" href="classfiftyone_1_1pipeline_1_1devicedetection_1_1_device_detection_on_premise.html">fiftyone\pipeline\devicedetection\DeviceDetectionOnPremise</a>;</div><div class="c-code__line"></div><div class="c-code__line">$device = <span class="c-code__keyword">new</span> DeviceDetectionOnPremise();</div><div class="c-code__line"></div><div class="c-code__line">$pipeline = <span class="c-code__keyword">new</span> PipelineBuilder();</div><div class="c-code__line"></div><div class="c-code__line">$pipeline = $pipeline-&gt;add($device)-&gt;build();</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Here we create a function that checks if a supplied User-Agent is a</span></div><div class="c-code__line"><span class="c-code__comment">// mobile device</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">function</span> failuretomatch_checkifmobile($pipeline, $userAgent = <span class="c-code__stringliteral">&#39;&#39;</span>)</div><div class="c-code__line">{</div><div class="c-code__line">    <span class="c-code__comment">// We create the flowData object that is used to add evidence to and read data from</span></div><div class="c-code__line">    $flowData = $pipeline-&gt;createFlowData();</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Add the User-Agent as evidence</span></div><div class="c-code__line"></div><div class="c-code__line">    $flowData-&gt;evidence-&gt;set(<span class="c-code__stringliteral">&#39;header.user-agent&#39;</span>, $userAgent);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Now we process the flowData</span></div><div class="c-code__line">    $result = $flowData-&gt;process();</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// First we check if the property we&#39;re looking for has a meaningful result</span></div><div class="c-code__line"></div><div class="c-code__line">    echo <span class="c-code__stringliteral">&quot;Does User-Agent &#39;&lt;b&gt;&quot;</span> . $userAgent . <span class="c-code__stringliteral">&quot;&lt;/b&gt;&#39; represent a mobile device?:&quot;</span>;</div><div class="c-code__line">    echo <span class="c-code__stringliteral">&quot;&lt;/br&gt;\n&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> ($result-&gt;device-&gt;ismobile-&gt;hasValue) {</div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> ($result-&gt;device-&gt;ismobile-&gt;value) {</div><div class="c-code__line">            echo <span class="c-code__stringliteral">&#39;Yes&#39;</span>;</div><div class="c-code__line">        } <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">            echo <span class="c-code__stringliteral">&#39;No&#39;</span>;</div><div class="c-code__line">        }</div><div class="c-code__line">    } <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line">        echo <span class="c-code__stringliteral">&quot;We don&#39;t know for sure. The reason given is:&quot;</span>;</div><div class="c-code__line">        echo <span class="c-code__stringliteral">&quot;&lt;/br&gt;\n&quot;</span>;</div><div class="c-code__line">        <span class="c-code__comment">// If it doesn&#39;t have a meaningful result, we echo out the reason why</span></div><div class="c-code__line">        <span class="c-code__comment">// it wasn&#39;t meaningful</span></div><div class="c-code__line">        echo $result-&gt;device-&gt;ismobile-&gt;noValueMessage;</div><div class="c-code__line">        echo <span class="c-code__stringliteral">&quot;&lt;/br&gt;\n&quot;</span>;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    echo <span class="c-code__stringliteral">&quot;&lt;/br&gt;\n&quot;</span>;</div><div class="c-code__line">    echo <span class="c-code__stringliteral">&quot;&lt;/br&gt;\n&quot;</span>;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Some example User-Agents to test</span></div><div class="c-code__line"></div><div class="c-code__line">$iPhoneUA = <span class="c-code__stringliteral">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_2 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C114&#39;</span>;</div><div class="c-code__line">failuretomatch_checkifmobile($pipeline, $iPhoneUA);</div><div class="c-code__line"></div><div class="c-code__line">$badUserAgent = <span class="c-code__stringliteral">&#39;nonsense ua...&#39;</span>;</div><div class="c-code__line">failuretomatch_checkifmobile($pipeline, $badUserAgent);</div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
